SET NOCOUNT ON

DECLARE @supplier TABLE (supplier_id INT, name nvarchar(128))
DECLARE @business_unit TABLE (business_unit_id INT)

INSERT @supplier (supplier_id, name)
SELECT DISTINCT s.supplier_id, s.name
FROM   supplier AS s
WHERE xref_code IN (
'ABLIMA',
'ALEEIGHT',
'ALWAYS',
'AMISH',
'BAITPLCE',
'BAITTCKL',
'BAKETEST',
'BARKETT',
'BEERCO',
'BESTCASE',
'BEVERAGE',
'BFISHER1',
'BLGREEN',
'BLMTN',
'BLUEHERO',
'BNBRIGHT',
'BREAD',
'BREITENB',
'BROSUPP1',
'BROSUPP2',
'BROUGHT',
'BROUGHTW',
'BROWNCO',
'CAVALIER',
'CITYBEVR',
'CLASALB',
'CLASBRAN',
'CLEVEJUC',
'CNTRSUPP',
'CNTRYGA',
'COKABRTA',
'COKAKROH',
'COKCINOH',
'COKCOLOH',
'COKDAYOH',
'COKECHIL',
'COKECLEV',
'COKEELYR',
'COKEHTN',
'COKEMANS',
'COKEYOUN',
'COKFINOH',
'COKFTWOH',
'COKLIMOH',
'COKPTMOH',
'COKTOLOH',
'COKWILOH',
'COKZANOH',
'COLOTENN',
'COLUBEVG',
'COLUDIST',
'CONNS',
'DAN DEE',
'DASDISTR',
'DEANSHAR',
'DEBBIE',
'DELMAR',
'DESHSUPP',
'DICKERSN',
'DMAWOOD',
'DONUTREA',
'EASTCHIC',
'ESBERBEV',
'FAYGOBVG',
'FISHBAIT',
'FLOWEREX',
'FLWRBAKE',
'FONTANA',
'FRESHFLW',
'FRITO',
'FRITOEPO',
'FRUITMOR',
'FUNBEV',
'GEMBEV',
'GLACERLQ',
'GOTTAGO',
'GRDNFOOD',
'GRIFPROD',
'GRIPPOFD',
'H.DENNT2',
'HAWKS',
'HBEERCIN',
'HBEERDTN',
'HBERGCLE',
'HBERGCOL',
'HBERGLOR',
'HBERGTOL',
'HEIJONPY',
'HEINERS2',
'HEISTWRT',
'HERRCHIP',
'HINKLES',
'HOFFCODS',
'HOLSM',
'HOMEBEVG',
'HOMECITY',
'HOSTBRD',
'HOSTPAST',
'HSLAROSE',
'HSLRSUMM',
'HWINECIN',
'IB010AOH',
'IB011AOH',
'IB021AOH',
'IB023AOH',
'IB036AOH',
'IB036BOH',
'IB046AOH',
'IB059AOH',
'IB084AOH',
'ICEE',
'IMPERIAL',
'INCOMM',
'INTEGRATE',
'IRONCTY',
'IRONINVO',
'JANSON',
'JUICESUN',
'JWSBAIT',
'KLOSTERM',
'KNOWNET',
'KRAFTTST',
'KRETEK',
'LANCE',
'LOYALTY',
'MANSFIEL',
'MAPLECIY',
'MARTYS',
'MARYANN',
'MATESICH',
'MAYSHED',
'MIKESELL',
'MILLROHI',
'MISTERB',
'MRSPORTS',
'MUXIE',
'NATUREBE',
'NETSPEND',
'NEXXAKRN',
'NEXXBUST',
'NEXXCINC',
'NEXXCOLU',
'NEXXFOOD',
'NEXXGAZ',
'NEXXHERD',
'NEXXPITT',
'NEXXPLA2',
'NEXXPLAI',
'NEXXRACE',
'NEXXRIP',
'NEXXUS',
'NICKCLEV',
'NICKMERR',
'NWODISTR',
'OHCITRUS',
'OHIOWINE',
'OHMULCH',
'OHTRNPK',
'OHWNINVO',
'OILDIST',
'OTISPUNK',
'OVWINECN',
'PAGE3',
'PAINEENT',
'PCTREATS',
'PEPDAYOH',
'PEPSAKRN',
'PEPSCANT',
'PEPSCHI3',
'PEPSCHIL',
'PEPSDEFI',
'PEPSDOVE',
'PEPSFIND',
'PEPSHAML',
'PEPSICIN',
'PEPSICLE',
'PEPSICOL',
'PEPSISP2',
'PEPSISPR',
'PEPSIWV',
'PEPSLIMA',
'PEPSMANS',
'PEPSNITR',
'PEPSRIP',
'PEPSTOLE',
'PETERSON',
'PFS',
'PLATFORM',
'POSTOFFC',
'PRAIRIEF',
'PRAIRMFN',
'PREPAID',
'PRMBEVG',
'PROSPORT',
'PUGSINC',
'QUICKBT',
'REDBULNA',
'REINHART',
'REINHRT4',
'REISUPP1',
'REISUPP2',
'REITER',
'REITERAK',
'RHINGEST',
'RLLIPASH',
'RLLIPELE',
'RLLIPTON',
'RMAP',
'RMBAKERY',
'ROBNDIST',
'ROSES',
'ROSSBAIT',
'RUMPKEE',
'SARATEST',
'SCHENKEL',
'SCHNSUPP',
'SCHWEBLS',
'SEALTSJM',
'SIZZ',
'SNOUFFER',
'SNYDER',
'SNYHANVR',
'SOLARAY',
'SOZACHRG',
'SPRBEVGE',
'SPRBEVNA',
'SPRIGGS',
'SSVARBVG',
'STANDNT',
'STANMAN',
'STEUBEN',
'STORE',
'STORERCH',
'STORESFL',
'SUBWAY',
'SUGARCRK',
'SUNCODSP',
'SUPER',
'SWISS1PA',
'SYFRTFD',
'SYSCOCIN',
'SYSCOCLV',
'TACOBELL',
'TONYFISH',
'TOTERECN',
'TRAMONTE',
'TREUHOUS',
'TRICNTY',
'TRIDIST2',
'TRIJUICE',
'TRISLER',
'TRISTATE',
'TROYER',
'TRUTHMC',
'UNIVEMAP',
'UNIVERSA',
'UPPERARL',
'USFOOD3',
'USFOOD4',
'UTZFOODS',
'VENCREDT',
'WALTCRAW',
'WASTEMGT',
'WINEDIST',
'WRPWING',
'WSBAIT')

/*
AND xref_code not like ('mcl%')
AND xref_code not like ('crm%')
AND xref_code not like ('eby%')

AND s.supplier_id IN (SELECT s.supplier_id
FROM   supplier AS s
WHERE EXISTS (	SELECT 1
				FROM supplier_da_effective_date_list dalst
				JOIN da_list_dro dro
				ON   dalst.supplier_id = s.supplier_id
				AND  dalst.data_accessor_id = dro.assigned_data_accessor_id
				JOIN business_unit AS bu
				ON   dro.current_org_hierarchy_id = bu.business_unit_id
				JOIN Rad_Sys_Data_Accessor AS rsda
				ON   rsda.data_accessor_id = bu.business_unit_id
				JOIN bcssa_custom_integration..bc_extract_production_bu_list As pbu
				ON   pbu.bu_code = rsda.name
				JOIN Address AS a
				ON   bu.address_id = a.address_id
				AND  a.state_code = 'OH'
				WHERE GETDATE() BETWEEN dalst.start_date and dalst.end_date
				)
)

AND s.supplier_type_code = 'm'
*/



            
SELECT ISNULL(xref_code, 'xref-' + CONVERT(NVARCHAR(15),s.supplier_id)) AS XRefCode,
REPLACe(s.name,',','~') AS Name
FROM Supplier as s
JOIN @Supplier AS s2
ON   s.supplier_id = s2.supplier_id
LEFT JOIN Address as a
ON s.address_id = a.address_id

ORDER by s.xref_code
GO

